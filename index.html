<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedAI360 | Enterprise Suite</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            /* Palette: Modern Indigo & Slate */
            --primary: #4F46E5;
            --primary-gradient: linear-gradient(135deg, #4F46E5 0%, #818CF8 100%);
            --secondary: #64748B;
            --bg-body: #F1F5F9;
            --bg-card: #FFFFFF;
            --surface: #F8FAFC;
            --text-main: #0F172A;
            --text-muted: #64748B;
            --border: #E2E8F0;
            
            /* Status Colors */
            --success-bg: #DCFCE7; --success-text: #166534;
            --danger-bg: #FEE2E2; --danger-text: #991B1B;
            --info-bg: #E0E7FF; --info-text: #3730A3;

            /* Premium Shadows */
            --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --glow: 0 0 20px rgba(79, 70, 229, 0.3);
        }

        body.dark-mode {
            --bg-body: #0F172A;
            --bg-card: #1E293B;
            --surface: #334155;
            --text-main: #F8FAFC;
            --text-muted: #94A3B8;
            --border: #334155;
            --shadow-md: 0 10px 15px -3px rgba(0,0,0,0.5);
        }

        * { box-sizing: border-box; outline: none; }
        body { margin: 0; font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg-body); color: var(--text-main); display: flex; height: 100vh; overflow: hidden; transition: 0.3s ease; }

        /* --- SIDEBAR --- */
        .sidebar { 
            width: 280px; background: var(--bg-card); padding: 30px 20px; 
            display: flex; flex-direction: column; border-right: 1px solid var(--border);
            z-index: 100; transition: 0.3s ease;
        }
        
        .logo { 
            font-size: 24px; font-weight: 800; color: var(--primary); margin-bottom: 50px; 
            display: flex; align-items: center; gap: 12px; letter-spacing: -0.5px;
        }
        
        .nav-item { 
            padding: 14px 18px; margin-bottom: 8px; border-radius: 12px; 
            color: var(--text-muted); font-weight: 600; cursor: pointer; 
            display: flex; align-items: center; gap: 14px; font-size: 14px; 
            transition: all 0.2s ease;
        }
        .nav-item:hover { background: var(--surface); color: var(--primary); transform: translateX(5px); }
        .nav-item.active { 
            background: var(--primary-gradient); color: white; 
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3); 
        }
        .nav-item.active:hover { transform: none; }

        /* --- MAIN AREA --- */
        .main { flex: 1; padding: 30px 40px; overflow-y: auto; position: relative; }
        
        /* Glass Header */
        .header { 
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; 
            background: rgba(255, 255, 255, 0.6); backdrop-filter: blur(12px);
            padding: 15px 25px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.8);
            position: sticky; top: 0; z-index: 90; box-shadow: var(--shadow-sm);
        }
        body.dark-mode .header { background: rgba(30, 41, 59, 0.7); border-color: rgba(255,255,255,0.1); }

        .btn-action { 
            width: 45px; height: 45px; border-radius: 12px; border: 1px solid var(--border); 
            background: var(--bg-card); display: flex; align-items: center; justify-content: center; 
            cursor: pointer; color: var(--text-muted); transition: 0.2s; font-size: 18px;
        }
        .btn-action:hover { color: var(--primary); border-color: var(--primary); background: var(--surface); }

        .btn-primary { 
            background: var(--primary-gradient); color: white; padding: 14px 28px; 
            border-radius: 12px; border: none; font-weight: 700; cursor: pointer; 
            display: flex; align-items: center; gap: 10px; transition: 0.3s; 
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.2); font-size: 14px;
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(79, 70, 229, 0.4); }

        /* --- CARDS & GRID --- */
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; margin-bottom: 30px; }
        .grid-custom { display: grid; grid-template-columns: 350px 1fr; gap: 30px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }

        .card { 
            background: var(--bg-card); border-radius: 24px; padding: 28px; 
            box-shadow: var(--shadow-md); border: 1px solid var(--border); 
            transition: 0.3s; position: relative; overflow: hidden;
        }
        .card:hover { transform: translateY(-4px); box-shadow: var(--shadow-lg); }

        /* Stats */
        .stat-card { display: flex; align-items: center; justify-content: space-between; }
        .stat-icon { 
            width: 56px; height: 56px; border-radius: 16px; 
            display: flex; align-items: center; justify-content: center; font-size: 24px; 
        }
        .stat-val { font-size: 28px; font-weight: 800; margin-top: 5px; color: var(--text-main); }
        .stat-label { font-size: 13px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }

        /* --- CONTROLS --- */
        .control-group { margin-bottom: 24px; background: var(--surface); padding: 15px; border-radius: 16px; border: 1px solid var(--border); }
        .label-row { display: flex; justify-content: space-between; font-size: 14px; font-weight: 700; margin-bottom: 10px; color: var(--text-main); }
        
        input[type=range] { width: 100%; height: 6px; background: var(--border); border-radius: 10px; -webkit-appearance: none; cursor: pointer; }
        input[type=range]::-webkit-slider-thumb { 
            -webkit-appearance: none; width: 22px; height: 22px; background: var(--primary); 
            border-radius: 50%; border: 4px solid var(--bg-card); box-shadow: 0 2px 6px rgba(0,0,0,0.3); transition: 0.2s; 
        }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.2); }

        /* --- ANALYSIS SECTION --- */
        .badge { padding: 6px 12px; border-radius: 30px; font-size: 12px; font-weight: 700; margin-right: 6px; display: inline-block; }
        .badge-blue { background: var(--info-bg); color: var(--info-text); }
        .badge-green { background: var(--success-bg); color: var(--success-text); }
        .badge-red { background: var(--danger-bg); color: var(--danger-text); }

        .upload-area { 
            border: 2px dashed var(--border); border-radius: 20px; padding: 60px; 
            text-align: center; cursor: pointer; transition: 0.3s; background: var(--surface);
        }
        .upload-area:hover { border-color: var(--primary); background: rgba(79, 70, 229, 0.05); }

        .molecule-item { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 12px; border-bottom: 1px solid var(--border); 
        }
        .molecule-item:last-child { border-bottom: none; }
        
        /* Tabs Logic */
        .tab-section { display: none; animation: slideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .tab-section.active { display: block; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Chart Containers */
        .chart-wrapper { position: relative; height: 320px; width: 100%; }
        .chart-wrapper-sm { position: relative; height: 180px; width: 100%; }

        /* Responsive */
        .mobile-menu-btn { display: none; font-size: 24px; cursor: pointer; }
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 95; backdrop-filter: blur(4px); }

        @media (max-width: 1100px) { .grid-4 { grid-template-columns: 1fr 1fr; } .grid-custom, .grid-2 { grid-template-columns: 1fr; } }
        @media (max-width: 768px) { 
            .sidebar { position: fixed; left: -300px; height: 100%; } .sidebar.active { left: 0; } 
            .main { padding: 20px; } .mobile-menu-btn { display: block; } .overlay.active { display: block; }
            .header { flex-wrap: wrap; gap: 15px; } 
        }
    </style>
</head>
<body>

    <div class="overlay" onclick="toggleSidebar()"></div>

    <nav class="sidebar" id="sidebar">
        <div class="logo">
            <div style="width: 40px; height: 40px; background: var(--primary-gradient); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white;">
                <i class="fas fa-dna"></i>
            </div>
            MedAI360
        </div>
        
        <div class="nav-item active" onclick="openTab('dashboard', this); toggleSidebar()">
            <i class="fas fa-th-large"></i> Dashboard
        </div>
        <div class="nav-item" onclick="openTab('quality', this); toggleSidebar()">
            <i class="fas fa-vials"></i> Batch Analysis
        </div>
        <div class="nav-item" onclick="openTab('analysis', this); toggleSidebar()">
            <i class="fas fa-wave-square"></i> HPLC View
        </div>
        <div class="nav-item" onclick="openTab('reports', this); toggleSidebar()">
            <i class="fas fa-file-contract"></i> Reports
        </div>

        <div style="margin-top: auto; border-top: 1px solid var(--border); padding-top: 20px;">
            <a href="/logout" class="nav-item" style="color: #ef4444;"><i class="fas fa-sign-out-alt"></i> Sign Out</a>
        </div>
    </nav>

    <main class="main">
        
        <header class="header">
            <div style="display: flex; align-items: center; gap: 20px;">
                <i class="fas fa-bars mobile-menu-btn" onclick="toggleSidebar()"></i>
                <div>
                    <h2 style="margin: 0; font-size: 22px; font-weight: 700;">Welcome back, {{ user }}</h2>
                    <span style="font-size: 14px; color: var(--text-muted);">Lab Status: <span style="color: var(--success-text); font-weight: 600;">● Operational</span></span>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px;">
                <button class="btn-action" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
                <button class="btn-action"><i class="fas fa-bell"></i></button>
                <button class="btn-primary" onclick="window.print()">
                    <i class="fas fa-download"></i> Export Report
                </button>
            </div>
        </header>

        <div id="dashboard" class="tab-section active">
            <div class="grid-4">
                <div class="card stat-card">
                    <div><div class="stat-label">Batches Processed</div><div class="stat-val">1,240</div></div>
                    <div class="stat-icon" style="background: var(--info-bg); color: var(--info-text);"><i class="fas fa-box-open"></i></div>
                </div>
                <div class="card stat-card">
                    <div><div class="stat-label">Avg. Purity</div><div class="stat-val">98.2%</div></div>
                    <div class="stat-icon" style="background: var(--success-bg); color: var(--success-text);"><i class="fas fa-check-circle"></i></div>
                </div>
                <div class="card stat-card">
                    <div><div class="stat-label">Efficiency</div><div class="stat-val">+24%</div></div>
                    <div class="stat-icon" style="background: #FFF7ED; color: #C2410C;"><i class="fas fa-chart-line"></i></div>
                </div>
                <div class="card stat-card">
                    <div><div class="stat-label">AI Accuracy</div><div class="stat-val">99.9%</div></div>
                    <div class="stat-icon" style="background: #F3E8FF; color: #7E22CE;"><i class="fas fa-brain"></i></div>
                </div>
            </div>

            <div class="grid-custom">
                <div class="card">
                    <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                        <h3 style="margin:0; font-size:18px;">AI Simulation</h3>
                        <span class="badge badge-green">READY</span>
                    </div>
                    
                    <div class="control-group">
                        <div class="label-row"><span>Temperature</span> <span id="val-temp" style="color:var(--primary)">50°C</span></div>
                        <input type="range" id="temp" min="0" max="100" value="50" oninput="updateUI('temp', 'val-temp', '°C')">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span>Solvent Ratio</span> <span id="val-sol" style="color:var(--primary)">50%</span></div>
                        <input type="range" id="sol" min="0" max="100" value="50" oninput="updateUI('sol', 'val-sol', '%')">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span>Pressure</span> <span id="val-pres" style="color:var(--primary)">50 Bar</span></div>
                        <input type="range" id="pres" min="0" max="100" value="50" oninput="updateUI('pres', 'val-pres', ' Bar')">
                    </div>

                    <div style="text-align:center; margin-bottom: 20px;">
                        <div style="font-size:36px; font-weight:800; color:var(--text-main);" id="yield-txt">0%</div>
                        <div style="font-size:12px; text-transform:uppercase; color:var(--text-muted); font-weight:700;">Predicted Yield</div>
                        <div style="margin-top:5px; font-size:14px; font-weight:600; color:var(--success-text);">Purity: <span id="purity-txt">--</span></div>
                    </div>

                    <button class="btn-primary" style="width:100%; justify-content:center;" onclick="runSim()">
                        Run Optimization
                    </button>
                </div>

                <div class="card">
                    <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                        <h3 style="margin:0; font-size:18px;">Real-time Density Monitoring</h3>
                        <button class="btn-action" style="width:35px; height:35px; font-size:14px;"><i class="fas fa-expand"></i></button>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="liveChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="quality" class="tab-section">
            
            <div class="card" style="margin-bottom: 30px;">
                <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:20px;">
                    <div>
                        <h3 style="margin:0; font-size:20px;">Batch QC Analysis</h3>
                        <p style="margin:5px 0 0; color:var(--text-muted);">Upload HPLC data to generate molecules, recipes, and overlay graphs.</p>
                    </div>
                    <div>
                        <button class="btn-primary" onclick="document.getElementById('csvInput').click()">
                            <i class="fas fa-cloud-upload-alt"></i> &nbsp; Upload CSV File
                        </button>
                        <input type="file" id="csvInput" hidden onchange="processAnalysis()">
                    </div>
                </div>
            </div>

            <div id="analysis-results" style="display: none;">
                <div class="grid-2">
                    
                    <div style="display:flex; flex-direction:column; gap:30px;">
                        <div class="card">
                            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                                <h3 style="margin:0;">HPLC Overlay</h3>
                                <div><span class="badge badge-blue">Batch</span> <span class="badge" style="background:var(--surface); color:var(--text-muted);">Reference</span></div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="hplcOverlayChart"></canvas>
                            </div>
                        </div>

                        <div class="card">
                            <h3 style="margin:0 0 15px 0;">Quality Alerts</h3>
                            <div id="alerts-list"></div>
                        </div>
                    </div>

                    <div style="display:flex; flex-direction:column; gap:30px;">
                        <div class="card" style="text-align:center; background: linear-gradient(135deg, var(--primary) 0%, #4338ca 100%); color: white;">
                            <div style="font-size:14px; opacity:0.8; font-weight:600; text-transform:uppercase;">Overall Purity Score</div>
                            <div style="font-size:56px; font-weight:800; line-height:1;" id="purity-val">--%</div>
                            <div style="margin-top:10px; font-size:14px; opacity:0.9;"><i class="fas fa-check-circle"></i> AI Verified</div>
                        </div>

                        <div class="card">
                            <h3 style="margin:0 0 15px 0;">Identified Molecules</h3>
                            <div id="molecule-list"></div>
                        </div>

                        <div class="card">
                            <h3 style="margin:0 0 15px 0;">AI Predictions</h3>
                            <div id="bio-badges" style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:20px;"></div>
                            
                            <div style="background: var(--success-bg); padding: 20px; border-radius: 16px; border: 1px solid #BBF7D0;">
                                <h4 style="margin:0 0 10px 0; color: var(--success-text); font-size:15px;">
                                    <i class="fas fa-flask"></i> Suggested Extraction Recipe
                                </h4>
                                <div style="display:flex; justify-content:space-between; font-size:14px; color: var(--success-text);">
                                    <span>Optimal Temp:</span> <strong id="rec-temp">--</strong>
                                </div>
                                <div style="display:flex; justify-content:space-between; font-size:14px; color: var(--success-text); margin-top:5px;">
                                    <span>Solvent Ratio:</span> <strong id="rec-sol">--</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="placeholder-view">
                <div class="upload-area" onclick="document.getElementById('csvInput').click()">
                    <i class="fas fa-file-csv" style="font-size: 50px; color: var(--text-muted); margin-bottom: 20px;"></i>
                    <h3 style="margin:0; color: var(--text-main);">No Analysis Data Found</h3>
                    <p style="color: var(--text-muted);">Please upload a batch CSV file to view advanced AI insights.</p>
                </div>
            </div>
        </div>

        <div id="analysis" class="tab-section">
            <div class="card">
                <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                    <h3 style="margin:0;">Raw Chromatogram View</h3>
                    <select style="padding: 8px 12px; border-radius: 8px; border:1px solid var(--border); outline:none;">
                        <option>Batch #4021</option>
                        <option>Batch #4022</option>
                    </select>
                </div>
                <div class="chart-wrapper">
                    <canvas id="hplcChart"></canvas>
                </div>
            </div>
        </div>

        <div id="reports" class="tab-section">
            <div class="card">
                <h3 style="margin:0 0 20px 0;">Generated Reports</h3>
                <table style="width:100%; border-collapse:collapse; text-align:left;">
                    <tr style="border-bottom:1px solid var(--border); color:var(--text-muted); font-size:12px; text-transform:uppercase;">
                        <th style="padding:15px;">Report Name</th>
                        <th>Type</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                    <tr>
                        <td style="padding:15px; font-weight:600;"><i class="fas fa-file-pdf" style="color:#ef4444; margin-right:10px;"></i> Extraction_Log_Dec.pdf</td>
                        <td>System Log</td>
                        <td><span class="badge badge-green">Ready</span></td>
                        <td><button class="btn-action" style="width:30px; height:30px;"><i class="fas fa-download"></i></button></td>
                    </tr>
                    <tr>
                        <td style="padding:15px; font-weight:600;"><i class="fas fa-file-excel" style="color:#10b981; margin-right:10px;"></i> Audit_Q4.xlsx</td>
                        <td>Quality</td>
                        <td><span class="badge badge-green">Ready</span></td>
                        <td><button class="btn-action" style="width:30px; height:30px;"><i class="fas fa-download"></i></button></td>
                    </tr>
                </table>
            </div>
        </div>

    </main>

<script>
    // --- UI HELPERS ---
    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('active');
        document.querySelector('.overlay').classList.toggle('active');
    }
    
    function toggleTheme() { document.body.classList.toggle('dark-mode'); }
    
    function openTab(tabName, el) {
        document.querySelectorAll('.tab-section').forEach(x => x.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(x => x.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        el.classList.add('active');
        
        // Resize Fix
        setTimeout(() => {
            if(window.liveChart) window.liveChart.resize();
            if(window.hplcChart) window.hplcChart.resize();
            if(window.overlayChart) window.overlayChart.resize();
        }, 100);
    }

    function updateUI(id, label, unit) { document.getElementById(label).innerText = document.getElementById(id).value + unit; }

    // --- SIMULATION ---
    async function runSim() {
        let btn = document.querySelector('#dashboard .btn-primary');
        let oldText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Processing AI...';
        
        let response = await fetch('/run_simulation', {
            method: 'POST', headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ temperature: document.getElementById('temp').value })
        });
        let result = await response.json();
        
        document.getElementById('yield-txt').innerText = result.yield + "%";
        document.getElementById('purity-txt').innerText = result.purity + "%";
        btn.innerHTML = oldText;
    }

    // --- ADVANCED BATCH ANALYSIS ---
    let overlayChart = null;

    async function processAnalysis() {
        const fileInput = document.getElementById('csvInput');
        const formData = new FormData();
        formData.append("file", fileInput.files[0]);

        document.getElementById('placeholder-view').style.display = 'none';
        document.getElementById('analysis-results').style.display = 'block';

        const response = await fetch('/upload_csv', { method: "POST", body: formData });
        const result = await response.json();

        if (result.success) {
            // Purity & Alerts
            document.getElementById('purity-val').innerText = result.purity + "%";
            
            let alertsHtml = "";
            if(result.alerts.length > 0) {
                result.alerts.forEach(a => alertsHtml += `<div style="background:var(--danger-bg); color:var(--danger-text); padding:10px; border-radius:10px; margin-bottom:8px; font-size:13px; font-weight:600;"><i class="fas fa-exclamation-triangle"></i> ${a}</div>`);
            } else {
                alertsHtml = `<div style="background:var(--success-bg); color:var(--success-text); padding:10px; border-radius:10px; font-size:13px; font-weight:600;"><i class="fas fa-check-circle"></i> Batch Passed Quality Check</div>`;
            }
            document.getElementById('alerts-list').innerHTML = alertsHtml;

            // Molecules
            document.getElementById('molecule-list').innerHTML = result.molecules.map(m => 
                `<div class="molecule-item"><span style="font-weight:700;">${m.name}</span><span class="badge badge-blue">${m.conc}</span></div>`
            ).join('');

            // Bioactivity
            document.getElementById('bio-badges').innerHTML = result.bioactivity.map(b => 
                `<span class="badge badge-blue" style="font-size:11px;">${b}</span>`
            ).join('');

            // Recipe
            document.getElementById('rec-temp').innerText = result.recipe.temp + " °C";
            document.getElementById('rec-sol').innerText = result.recipe.solvent + "% Ethanol";

            // Overlay Graph
            const ctx = document.getElementById('hplcOverlayChart').getContext('2d');
            if(overlayChart) overlayChart.destroy();
            
            const labels = Array.from({length: result.chart_batch.length}, (_, i) => i);
            
            // Create Gradients
            let grad1 = ctx.createLinearGradient(0,0,0,400);
            grad1.addColorStop(0, 'rgba(79, 70, 229, 0.4)'); grad1.addColorStop(1, 'rgba(79, 70, 229, 0)');
            
            overlayChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Batch Sample', data: result.chart_batch, borderColor: '#4F46E5', backgroundColor: grad1, borderWidth: 2, pointRadius: 0, fill: true, tension: 0.4 },
                        { label: 'Reference Std', data: result.chart_ref, borderColor: '#94A3B8', borderWidth: 2, borderDash: [5,5], pointRadius: 0, tension: 0.4 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { legend: { position: 'top', labels: { usePointStyle: true } } },
                    scales: { x: { grid: { display: false } }, y: { display: false } }
                }
            });
        }
    }

    // --- STATIC CHARTS ---
    const ctxLive = document.getElementById('liveChart').getContext('2d');
    let gradLive = ctxLive.createLinearGradient(0,0,0,300);
    gradLive.addColorStop(0, 'rgba(16, 185, 129, 0.2)'); gradLive.addColorStop(1, 'rgba(16, 185, 129, 0)');

    window.liveChart = new Chart(ctxLive, {
        type: 'line',
        data: {
            labels: ['1s','2s','3s','4s','5s','6s'],
            datasets: [{ label: 'Density', data: [20,35,30,55,45,60], borderColor: '#10B981', backgroundColor: gradLive, fill:true, tension: 0.4, pointRadius: 4, pointBackgroundColor: '#fff', borderWidth: 2 }]
        },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
    });

    const ctxHplc = document.getElementById('hplcChart').getContext('2d');
    let hplcData = []; for(let i=0; i<30; i+=0.5) { let y = Math.random()*5; y+=40*Math.exp(-Math.pow(i-15,2)/5); hplcData.push(y); }
    
    window.hplcChart = new Chart(ctxHplc, {
        type: 'line',
        data: { labels: Array.from({length: hplcData.length},(_,i)=>i), datasets: [{ data: hplcData, borderColor: '#4F46E5', borderWidth: 2, pointRadius: 0, tension: 0.4 }] },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false } }, y: { display: false } } }
    });

</script>
</body>
</html>